<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Winnestar Moshi Fashion</title>
<meta name="theme-color" content="#8B1A4A">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Winnestar Fashion">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
:root{
  --wine:#8B1A4A; --wine-dark:#5C0F30; --wine-light:#B5396D;
  --rose:#F4A7B9; --rose-light:#FDE8EE; --rose-pale:#FFF5F8;
  --gold:#C9963A; --gold-light:#F0D080; --gold-pale:#FFF8E7;
  --nude:#E8C9A0; --nude-dark:#8B6343;
  --white:#FFFFFF; --dark:#1A0A10; --gray:#7A6070;
  --border:#F0D8E4;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--rose-pale);font-family:'Jost',sans-serif;color:var(--dark);min-height:100vh;}

/* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
nav{background:linear-gradient(135deg,var(--wine-dark) 0%,var(--wine) 50%,#A0274F 100%);padding:14px 16px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;box-shadow:0 4px 24px rgba(91,15,48,0.5);}
.brand{display:flex;align-items:center;gap:10px;}
.brand-icon{width:40px;height:40px;background:rgba(255,255,255,0.15);border-radius:50%;border:2px solid rgba(240,208,128,0.6);display:flex;align-items:center;justify-content:center;font-size:1.2rem;}
.brand-name{font-family:'Cormorant Garamond',serif;color:var(--white);font-size:1.05rem;font-weight:700;line-height:1.1;}
.brand-tag{font-size:0.6rem;color:var(--gold-light);letter-spacing:2.5px;text-transform:uppercase;margin-top:1px;}
.status-pill{padding:4px 12px;border-radius:20px;font-size:0.7rem;font-weight:600;letter-spacing:1px;border:1px solid rgba(255,255,255,0.3);}
.status-open{background:rgba(255,255,255,0.2);color:white;}
.status-closed{background:rgba(0,0,0,0.25);color:rgba(255,255,255,0.65);}

/* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
.tabs{display:flex;gap:0;background:white;border-bottom:2px solid var(--border);overflow-x:auto;scrollbar-width:none;}
.tabs::-webkit-scrollbar{display:none;}
.tab{flex:1;min-width:70px;padding:11px 8px;font-size:0.75rem;font-weight:500;cursor:pointer;text-align:center;white-space:nowrap;color:var(--gray);border-bottom:3px solid transparent;transition:all 0.2s;font-family:'Jost',sans-serif;}
.tab.active{color:var(--wine);border-bottom-color:var(--wine);font-weight:600;}

/* ‚îÄ‚îÄ PAGES ‚îÄ‚îÄ */
.page{display:none;padding:16px;max-width:480px;margin:0 auto;padding-bottom:100px;}
.page.active{display:block;animation:fadeIn 0.3s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
.hero{position:relative;background:linear-gradient(160deg,var(--wine-dark),var(--wine) 45%,var(--wine-light) 100%);border-radius:24px;padding:32px 20px;text-align:center;color:white;overflow:hidden;margin-bottom:20px;}
.hero-circle1{position:absolute;top:-40px;right:-40px;width:140px;height:140px;background:rgba(255,255,255,0.06);border-radius:50%;}
.hero-circle2{position:absolute;bottom:-30px;left:-30px;width:100px;height:100px;background:rgba(201,150,58,0.15);border-radius:50%;}
.hero-circle3{position:absolute;top:20px;left:10px;width:60px;height:60px;background:rgba(255,255,255,0.04);border-radius:50%;}
.hero-ribbon{display:inline-block;background:rgba(201,150,58,0.25);border:1px solid rgba(240,208,128,0.4);border-radius:20px;padding:4px 14px;font-size:0.68rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold-light);margin-bottom:12px;}
.hero h1{font-family:'Cormorant Garamond',serif;font-size:2rem;font-weight:700;line-height:1.2;margin-bottom:10px;}
.hero h1 em{color:var(--gold-light);font-style:italic;}
.hero p{font-size:0.88rem;opacity:0.88;margin-bottom:22px;line-height:1.6;}
.hero-cta{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(135deg,var(--gold),#E0AA50);color:var(--dark);border:none;padding:13px 28px;border-radius:30px;font-size:0.9rem;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;box-shadow:0 6px 20px rgba(201,150,58,0.4);}

/* ‚îÄ‚îÄ PROMO BANNER ‚îÄ‚îÄ */
.promo-banner{background:linear-gradient(135deg,var(--gold-pale),#FFF0D0);border:1px solid rgba(201,150,58,0.3);border-radius:14px;padding:12px 16px;display:flex;align-items:center;gap:12px;margin-bottom:16px;}
.promo-icon{font-size:1.6rem;}
.promo-text{flex:1;}
.promo-title{font-size:0.82rem;font-weight:600;color:var(--nude-dark);}
.promo-sub{font-size:0.72rem;color:#A07840;margin-top:1px;}

/* ‚îÄ‚îÄ INFO GRID ‚îÄ‚îÄ */
.info-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px;}
.info-card{background:white;border-radius:16px;padding:14px;box-shadow:0 2px 12px rgba(139,26,74,0.07);border:1px solid var(--border);}
.info-icon{font-size:1.3rem;margin-bottom:6px;}
.info-lbl{font-size:0.62rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--wine);font-weight:600;margin-bottom:3px;}
.info-val{font-size:0.82rem;font-weight:600;color:var(--dark);line-height:1.4;}

/* ‚îÄ‚îÄ STEPS ‚îÄ‚îÄ */
.steps{background:white;border-radius:18px;padding:16px;box-shadow:0 2px 12px rgba(139,26,74,0.07);border:1px solid var(--border);margin-bottom:20px;}
.step{display:flex;gap:12px;align-items:flex-start;padding:10px 0;border-bottom:1px solid var(--border);}
.step:last-child{border-bottom:none;padding-bottom:0;}
.step-num{width:30px;height:30px;min-width:30px;background:linear-gradient(135deg,var(--wine),var(--wine-light));border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:0.8rem;}
.step-title{font-weight:600;font-size:0.85rem;color:var(--dark);}
.step-sub{font-size:0.75rem;color:var(--gray);margin-top:2px;}

/* ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ */
.sec-title{margin-bottom:14px;}
.sec-title h2{font-family:'Cormorant Garamond',serif;font-size:1.5rem;color:var(--dark);}
.sec-title p{font-size:0.8rem;color:var(--gray);margin-top:2px;}

/* ‚îÄ‚îÄ CATEGORY FILTER ‚îÄ‚îÄ */
.cat-filter{display:flex;gap:8px;overflow-x:auto;padding-bottom:8px;margin-bottom:16px;scrollbar-width:none;}
.cat-filter::-webkit-scrollbar{display:none;}
.cat-pill{padding:7px 16px;border-radius:20px;font-size:0.76rem;font-weight:500;cursor:pointer;white-space:nowrap;border:1.5px solid var(--border);color:var(--gray);background:white;font-family:'Jost',sans-serif;transition:all 0.2s;}
.cat-pill.active{background:linear-gradient(135deg,var(--wine),var(--wine-light));color:white;border-color:transparent;box-shadow:0 4px 12px rgba(139,26,74,0.3);}

/* ‚îÄ‚îÄ PRODUCT CARDS ‚îÄ‚îÄ */
.products-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.pcard{background:white;border-radius:18px;overflow:hidden;box-shadow:0 2px 16px rgba(139,26,74,0.09);border:1px solid var(--border);cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;}
.pcard:hover{transform:translateY(-3px);box-shadow:0 10px 28px rgba(139,26,74,0.18);}
.pcard-img{width:100%;height:150px;object-fit:cover;background:linear-gradient(135deg,var(--rose-light),#FCE4EC);}
.pcard-img-ph{width:100%;height:150px;background:linear-gradient(135deg,var(--rose-light),var(--border));display:flex;align-items:center;justify-content:center;font-size:3rem;}
.pcard-badge{position:absolute;top:8px;left:8px;background:linear-gradient(135deg,var(--gold),#E0AA50);color:var(--dark);padding:3px 8px;border-radius:8px;font-size:0.62rem;font-weight:700;}
.pcard-img-wrap{position:relative;}
.pcard-body{padding:10px;}
.pcard-cat{font-size:0.65rem;text-transform:uppercase;letter-spacing:1px;color:var(--wine);font-weight:600;margin-bottom:3px;}
.pcard-name{font-size:0.85rem;font-weight:600;color:var(--dark);margin-bottom:4px;line-height:1.3;}
.pcard-price{font-family:'Cormorant Garamond',serif;font-size:1.05rem;font-weight:700;color:var(--wine);}
.pcard-sizes{display:flex;gap:3px;flex-wrap:wrap;margin:5px 0;}
.sz-dot{padding:2px 6px;border-radius:6px;font-size:0.6rem;font-weight:600;background:var(--rose-light);color:var(--wine);}
.sz-dot.out{background:#FEE2E2;color:#EF4444;text-decoration:line-through;}
.pcard-btn{width:100%;padding:9px;background:linear-gradient(135deg,var(--wine),var(--wine-light));color:white;border:none;border-radius:10px;font-size:0.78rem;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;transition:opacity 0.2s;}
.pcard-btn:hover{opacity:0.9;}
.pcard-btn.out{background:#E5E7EB;color:#9CA3AF;cursor:not-allowed;}

/* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
.overlay{display:none;position:fixed;inset:0;background:rgba(26,10,16,0.6);z-index:200;align-items:flex-end;backdrop-filter:blur(2px);}
.overlay.show{display:flex;}
.modal{background:white;border-radius:28px 28px 0 0;padding:24px 20px 30px;width:100%;max-height:92vh;overflow-y:auto;}
.modal-handle{width:36px;height:4px;background:var(--border);border-radius:2px;margin:0 auto 20px;}
.modal-product-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:700;color:var(--dark);margin-bottom:4px;}
.modal-product-price{font-size:0.9rem;color:var(--wine);font-weight:600;margin-bottom:18px;}
.flabel{display:block;font-size:0.72rem;font-weight:600;color:var(--wine);margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px;}
.finput{width:100%;padding:12px 14px;border:2px solid var(--border);border-radius:12px;font-size:0.88rem;font-family:'Jost',sans-serif;color:var(--dark);outline:none;background:white;transition:border-color 0.2s;}
.finput:focus{border-color:var(--wine-light);}
.fgroup{margin-bottom:14px;}
.size-row{display:flex;gap:8px;flex-wrap:wrap;}
.sz-btn{padding:9px 14px;border-radius:10px;border:2px solid var(--border);background:white;color:var(--dark);font-size:0.82rem;font-weight:600;cursor:pointer;transition:all 0.2s;font-family:'Jost',sans-serif;}
.sz-btn.sel{background:linear-gradient(135deg,var(--wine),var(--wine-light));color:white;border-color:transparent;box-shadow:0 4px 12px rgba(139,26,74,0.3);}
.sz-btn.out{opacity:0.35;cursor:not-allowed;text-decoration:line-through;}
.qty-row{display:flex;align-items:center;gap:16px;}
.qty-btn{width:38px;height:38px;border-radius:50%;background:var(--rose-light);border:none;font-size:1.3rem;cursor:pointer;color:var(--wine);font-weight:700;font-family:'Jost',sans-serif;}
.qty-num{font-size:1.5rem;font-weight:700;color:var(--dark);min-width:32px;text-align:center;font-family:'Cormorant Garamond',serif;}
.total-box{background:linear-gradient(135deg,var(--rose-light),var(--gold-pale));border-radius:14px;padding:14px;text-align:center;margin:14px 0;}
.total-lbl{font-size:0.7rem;text-transform:uppercase;letter-spacing:2px;color:var(--wine);font-weight:600;margin-bottom:4px;}
.total-amt{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:700;color:var(--wine-dark);}
.submit-btn{width:100%;padding:15px;background:linear-gradient(135deg,var(--wine-dark),var(--wine),var(--wine-light));color:white;border:none;border-radius:14px;font-size:1rem;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;box-shadow:0 6px 20px rgba(139,26,74,0.4);margin-top:8px;}
.close-x{position:absolute;top:16px;right:16px;background:var(--rose-light);border:none;width:34px;height:34px;border-radius:50%;cursor:pointer;font-size:1rem;color:var(--wine);}

/* ‚îÄ‚îÄ SUCCESS ‚îÄ‚îÄ */
.success-screen{display:none;position:fixed;inset:0;background:linear-gradient(160deg,var(--wine-dark),var(--wine) 50%,var(--wine-light));z-index:300;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:32px 20px;}
.success-screen.show{display:flex;}
.success-sparkle{font-size:4.5rem;margin-bottom:16px;animation:pop 0.5s ease;}
@keyframes pop{0%{transform:scale(0)}70%{transform:scale(1.15)}100%{transform:scale(1)}}
.success-screen h2{font-family:'Cormorant Garamond',serif;font-size:2rem;color:white;margin-bottom:8px;}
.success-screen p{color:rgba(255,255,255,0.88);font-size:0.9rem;margin-bottom:20px;line-height:1.6;}
.success-id{background:rgba(255,255,255,0.18);border:1px solid rgba(255,255,255,0.3);border-radius:12px;padding:10px 22px;color:white;font-weight:700;margin-bottom:24px;font-size:0.88rem;letter-spacing:1px;}
.wa-btn{display:flex;align-items:center;justify-content:center;gap:10px;background:#25D366;color:white;border:none;padding:16px 28px;border-radius:30px;font-size:1rem;font-family:'Jost',sans-serif;font-weight:600;cursor:pointer;width:100%;box-shadow:0 6px 20px rgba(37,211,102,0.4);margin-bottom:12px;text-decoration:none;}
.again-btn{background:rgba(255,255,255,0.15);color:white;border:2px solid rgba(255,255,255,0.35);padding:14px;border-radius:30px;font-size:0.9rem;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;width:100%;}

/* ‚îÄ‚îÄ INFO PAGE ‚îÄ‚îÄ */
.info-section{background:white;border-radius:18px;padding:18px;box-shadow:0 2px 12px rgba(139,26,74,0.07);border:1px solid var(--border);margin-bottom:14px;}
.info-section h3{font-family:'Cormorant Garamond',serif;font-size:1.1rem;margin-bottom:14px;color:var(--dark);display:flex;align-items:center;gap:8px;}
.contact-row{display:flex;align-items:center;gap:10px;padding:12px 14px;border-radius:12px;margin-bottom:8px;cursor:pointer;border:none;width:100%;font-family:'Jost',sans-serif;font-size:0.88rem;font-weight:500;}
.contact-call{background:var(--rose-light);color:var(--wine);}
.contact-wa{background:#DCFCE7;color:#166534;}
.hours-table{width:100%;font-size:0.82rem;border-collapse:collapse;}
.hours-table tr{border-bottom:1px solid var(--border);}
.hours-table td{padding:9px 4px;}
.hours-table td:first-child{font-weight:600;color:var(--dark);}
.hours-table td:last-child{text-align:right;color:var(--wine);}
tr.today-row td{background:#FFF5F8;color:var(--wine-dark)!important;font-weight:700!important;}

/* ‚îÄ‚îÄ ADMIN ‚îÄ‚îÄ */
.admin-login-wrap{text-align:center;padding:10px 0 20px;}
.admin-login-icon{font-size:3.5rem;margin-bottom:12px;}
.login-card{background:white;border-radius:20px;padding:24px;box-shadow:0 4px 24px rgba(139,26,74,0.12);border:1px solid var(--border);}
.login-card h2{font-family:'Cormorant Garamond',serif;font-size:1.4rem;margin-bottom:4px;}
.login-card p{font-size:0.8rem;color:var(--gray);margin-bottom:20px;}
.stat-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;}
.stat-card{border-radius:16px;padding:16px;color:white;text-align:center;}
.s-wine{background:linear-gradient(135deg,var(--wine-dark),var(--wine));}
.s-gold{background:linear-gradient(135deg,#B8860B,var(--gold));}
.s-rose{background:linear-gradient(135deg,#9B1B60,var(--wine-light));}
.s-nude{background:linear-gradient(135deg,var(--nude-dark),#C49A6C);}
.stat-v{font-family:'Cormorant Garamond',serif;font-size:1.5rem;font-weight:700;}
.stat-l{font-size:0.65rem;opacity:0.88;text-transform:uppercase;letter-spacing:1px;margin-top:3px;}
.adm-tabs{display:flex;gap:0;background:var(--rose-pale);border-radius:14px;padding:4px;margin-bottom:16px;overflow-x:auto;}
.adm-tab{flex:1;min-width:70px;padding:8px 10px;border-radius:10px;font-size:0.72rem;font-weight:500;cursor:pointer;text-align:center;white-space:nowrap;color:var(--gray);border:none;background:transparent;font-family:'Jost',sans-serif;transition:all 0.2s;}
.adm-tab.active{background:white;color:var(--wine);font-weight:600;box-shadow:0 2px 8px rgba(139,26,74,0.12);}
.adm-card{background:white;border-radius:16px;padding:16px;box-shadow:0 2px 12px rgba(139,26,74,0.07);border:1px solid var(--border);margin-bottom:12px;}
.adm-card h3{font-family:'Cormorant Garamond',serif;font-size:1rem;margin-bottom:12px;color:var(--dark);}
.order-card{border:1px solid var(--border);border-radius:14px;padding:12px;margin-bottom:8px;background:white;}
.order-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;}
.order-num{font-size:0.72rem;font-weight:700;color:var(--wine);letter-spacing:0.5px;}
.badge{padding:3px 10px;border-radius:10px;font-size:0.65rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;}
.b-pending{background:#FEF3C7;color:#92400E;}
.b-confirmed{background:#DBEAFE;color:#1E40AF;}
.b-paid{background:#D1FAE5;color:#065F46;}
.b-delivered{background:var(--rose-light);color:var(--wine-dark);}
.order-info{font-size:0.78rem;color:var(--gray);margin-bottom:3px;}
.order-info strong{color:var(--dark);}
.status-sel{padding:7px 10px;border:1.5px solid var(--border);border-radius:8px;font-size:0.75rem;font-family:'Jost',sans-serif;color:var(--dark);background:white;width:100%;margin-top:8px;outline:none;}
.alert{padding:10px 14px;border-radius:10px;font-size:0.8rem;margin-bottom:12px;}
.alert-err{background:#FEE2E2;color:#991B1B;border:1px solid #FCA5A5;}
.alert-ok{background:#D1FAE5;color:#065F46;border:1px solid #6EE7B7;}
.search-box{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:12px;font-size:0.85rem;font-family:'Jost',sans-serif;outline:none;margin-bottom:12px;}
.filter-row{display:flex;gap:6px;overflow-x:auto;margin-bottom:12px;scrollbar-width:none;}
.filter-row::-webkit-scrollbar{display:none;}
.fpill{padding:6px 14px;border-radius:12px;font-size:0.72rem;font-weight:500;cursor:pointer;white-space:nowrap;border:1.5px solid var(--border);color:var(--gray);background:white;font-family:'Jost',sans-serif;}
.fpill.active{background:var(--wine);color:white;border-color:transparent;}
.prod-row{border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:8px;background:white;display:flex;gap:12px;align-items:center;}
.prod-thumb{width:58px;height:58px;border-radius:10px;object-fit:cover;background:linear-gradient(135deg,var(--rose-light),var(--border));display:flex;align-items:center;justify-content:center;font-size:1.5rem;flex-shrink:0;}
.prod-info{flex:1;}
.prod-name{font-weight:600;font-size:0.85rem;color:var(--dark);}
.prod-price-line{font-size:0.73rem;color:var(--wine);margin-top:2px;}
.stock-chips{display:flex;gap:3px;flex-wrap:wrap;margin-top:5px;}
.chip{padding:2px 7px;border-radius:6px;font-size:0.62rem;font-weight:700;}
.c-ok{background:#D1FAE5;color:#065F46;}
.c-low{background:#FEF3C7;color:#92400E;}
.c-out{background:#FEE2E2;color:#DC2626;}
.low-alert{background:#FEF3C7;border:1px solid #FDE68A;border-radius:12px;padding:10px 14px;margin-bottom:8px;font-size:0.78rem;color:#92400E;}
.upload-zone{border:2px dashed #E0B8CC;border-radius:14px;padding:20px;text-align:center;cursor:pointer;background:#FFF8FA;transition:all 0.2s;}
.upload-zone:hover{border-color:var(--wine);background:var(--rose-light);}
.chart-wrap{height:170px;display:flex;align-items:flex-end;gap:6px;padding:0 2px;}
.bar-col{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;}
.bar-fill{width:100%;background:linear-gradient(to top,var(--wine-dark),var(--wine-light));border-radius:6px 6px 0 0;transition:height 0.6s ease;min-height:4px;}
.bar-lbl{font-size:0.58rem;color:var(--gray);}
.bar-v{font-size:0.58rem;color:var(--wine);font-weight:700;}
.profit-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border);font-size:0.85rem;}
.profit-row:last-child{border-bottom:none;}
.best-row{display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid var(--border);font-size:0.82rem;}
.best-row:last-child{border-bottom:none;}

/* ‚îÄ‚îÄ FLOATING ‚îÄ‚îÄ */
.wa-float{position:fixed;bottom:90px;right:16px;background:#25D366;color:white;width:52px;height:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;box-shadow:0 4px 18px rgba(37,211,102,0.45);text-decoration:none;z-index:99;}

/* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
.footer{text-align:center;padding:18px 16px;font-size:0.72rem;color:#B09AAA;border-top:1px solid var(--border);margin-top:8px;}
.footer strong{color:var(--wine);}

/* ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ */
.btn-sm{padding:7px 14px;border-radius:8px;border:none;font-size:0.75rem;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;}
.btn-wine{background:var(--wine);color:white;}
.btn-outline{background:white;color:var(--wine);border:1.5px solid var(--wine);}
.btn-red{background:#EF4444;color:white;}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="brand">
    <div class="brand-icon">üëó</div>
    <div>
      <div class="brand-name">Winnestar Moshi Fashion</div>
      <div class="brand-tag">Women's Boutique ¬∑ Moshi, Tanzania</div>
    </div>
  </div>
  <div class="status-pill status-open" id="navStatus">‚óè Open</div>
</nav>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="showPage('home')" id="tab-home">üè† Home</div>
  <div class="tab" onclick="showPage('shop')" id="tab-shop">üëó Shop</div>
  <div class="tab" onclick="showPage('info')" id="tab-info">‚ÑπÔ∏è Info</div>
  <div class="tab" onclick="showPage('admin')" id="tab-admin">üîê Admin</div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HOME ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page active" id="page-home">
  <div class="hero">
    <div class="hero-circle1"></div>
    <div class="hero-circle2"></div>
    <div class="hero-circle3"></div>
    <div class="hero-ribbon">‚ú® New Collection Available</div>
    <h1>Dress to <em>Impress</em><br>Feel Like a Queen</h1>
    <p>Curated women's fashion straight from Moshi Center.<br>Quality pieces. Affordable prices. Delivered to you.</p>
    <button class="hero-cta" onclick="showPage('shop')">üõç Explore Collection</button>
  </div>

  <div class="promo-banner">
    <div class="promo-icon">üöö</div>
    <div class="promo-text">
      <div class="promo-title">Free Delivery within Moshi Center</div>
      <div class="promo-sub">WhatsApp us to arrange delivery to your location</div>
    </div>
  </div>

  <div class="info-grid">
    <div class="info-card">
      <div class="info-icon">üìç</div>
      <div class="info-lbl">Location</div>
      <div class="info-val">Moshi Center<br>Kilimanjaro, TZ</div>
    </div>
    <div class="info-card">
      <div class="info-icon">üì±</div>
      <div class="info-lbl">WhatsApp</div>
      <div class="info-val">0619 066 079</div>
    </div>
    <div class="info-card">
      <div class="info-icon">üïê</div>
      <div class="info-lbl">Today's Hours</div>
      <div class="info-val" id="todayHours">8:00 AM ‚Äì 8:00 PM</div>
    </div>
    <div class="info-card">
      <div class="info-icon">‚ú®</div>
      <div class="info-lbl">Specialty</div>
      <div class="info-val">Women's Fashion & Accessories</div>
    </div>
  </div>

  <div class="sec-title"><h2>How to Order</h2><p>3 simple steps to get your fashion</p></div>
  <div class="steps">
    <div class="step">
      <div class="step-num">1</div>
      <div><div class="step-title">Browse & Select</div><div class="step-sub">Go to Shop tab, pick your item, size and quantity</div></div>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div><div class="step-title">Enter Your Details</div><div class="step-sub">Provide your name, phone & delivery location</div></div>
    </div>
    <div class="step">
      <div class="step-num">3</div>
      <div><div class="step-title">Confirm via WhatsApp</div><div class="step-sub">Tap the button ‚Äî your order goes directly to us!</div></div>
    </div>
  </div>

  <div class="footer">Generated by <strong>Sam Done</strong> ¬∑ 0619066079</div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SHOP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-shop">
  <div class="sec-title"><h2>Our Collection</h2><p>Tap any item to order</p></div>
  <div class="cat-filter" id="catFilter">
    <div class="cat-pill active" onclick="filterCat('all',this)">All</div>
    <div class="cat-pill" onclick="filterCat('Dresses',this)">üëó Dresses</div>
    <div class="cat-pill" onclick="filterCat('Tops',this)">üëö Tops</div>
    <div class="cat-pill" onclick="filterCat('Skirts',this)">ü©± Skirts</div>
    <div class="cat-pill" onclick="filterCat('Trousers',this)">üëñ Trousers</div>
    <div class="cat-pill" onclick="filterCat('Suits',this)">ü§µ‚Äç‚ôÄÔ∏è Suits</div>
    <div class="cat-pill" onclick="filterCat('Accessories',this)">üíç Accessories</div>
  </div>
  <div class="products-grid" id="productsGrid">
    <div style="grid-column:span 2;text-align:center;padding:50px 20px;color:var(--gray)">
      <div style="font-size:2.5rem;margin-bottom:10px">üëó</div>
      <p>Loading collection...</p>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INFO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-info">
  <div class="info-section">
    <h3>üìç Visit Us</h3>
    <p style="font-size:0.85rem;color:var(--gray);margin-bottom:14px;line-height:1.6">Winnestar Moshi Fashion is located at Moshi Center, Kilimanjaro, Tanzania. Come visit us or shop online!</p>
    <button class="contact-row contact-call" onclick="window.open('tel:0619066079')">üìû Call ‚Äî 0619066079</button>
    <button class="contact-row contact-wa" onclick="window.open('https://wa.me/255619066079')">üí¨ WhatsApp Us</button>
  </div>

  <div class="info-section">
    <h3>üïê Opening Hours</h3>
    <table class="hours-table">
      <tr id="row-1"><td>Monday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-2"><td>Tuesday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-3"><td>Wednesday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-4"><td>Thursday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-5"><td>Friday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-6"><td>Saturday</td><td>8:00 AM ‚Äì 8:00 PM</td></tr>
      <tr id="row-0"><td>Sunday</td><td>10:00 AM ‚Äì 5:00 PM</td></tr>
    </table>
  </div>

  <div class="info-section">
    <h3>üíú About Winnestar Fashion</h3>
    <p style="font-size:0.85rem;color:var(--gray);line-height:1.7">Winnestar Moshi Fashion is a premier women's boutique in the heart of Moshi Center, Tanzania. We bring you the latest trends in women's clothing ‚Äî from elegant dresses to casual tops, skirts, trousers and accessories. Every woman deserves to feel beautiful, and we're here to make that happen at prices you'll love.</p>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-admin">
  <div id="adminLogin">
    <div class="admin-login-wrap">
      <div class="admin-login-icon">üîê</div>
      <div style="font-family:'Cormorant Garamond',serif;font-size:1.5rem;margin-bottom:4px">Admin Login</div>
      <div style="font-size:0.8rem;color:var(--gray);margin-bottom:20px">Winnestar Boutique Control Hub</div>
    </div>
    <div class="login-card">
      <div id="loginAlert"></div>
      <div class="fgroup">
        <label class="flabel">Username</label>
        <input class="finput" id="adminUser" type="text" placeholder="Enter username"/>
      </div>
      <div class="fgroup">
        <label class="flabel">Password</label>
        <input class="finput" id="adminPass" type="password" placeholder="Enter password"/>
      </div>
      <button class="submit-btn" onclick="adminLogin()">Login to Dashboard</button>
    </div>
  </div>

  <div id="adminDashboard" style="display:none">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
      <div><div style="font-family:'Cormorant Garamond',serif;font-size:1.3rem">Control Hub</div><div style="font-size:0.72rem;color:var(--gray)">Winnestar Moshi Fashion</div></div>
      <button class="btn-sm btn-outline" onclick="adminLogout()">Logout</button>
    </div>

    <div class="adm-tabs">
      <button class="adm-tab active" onclick="admTab('overview',this)">üìä Overview</button>
      <button class="adm-tab" onclick="admTab('orders',this)">üì¶ Orders</button>
      <button class="adm-tab" onclick="admTab('products',this)">üëó Products</button>
      <button class="adm-tab" onclick="admTab('analytics',this)">üìà Analytics</button>
    </div>

    <!-- OVERVIEW -->
    <div id="adm-overview">
      <div class="stat-grid">
        <div class="stat-card s-wine"><div class="stat-v" id="sTotalOrders">0</div><div class="stat-l">Total Orders</div></div>
        <div class="stat-card s-gold"><div class="stat-v" id="sTotalSales">0</div><div class="stat-l">Revenue (TZS)</div></div>
        <div class="stat-card s-rose"><div class="stat-v" id="sTotalProfit">0</div><div class="stat-l">Profit (TZS)</div></div>
        <div class="stat-card s-nude"><div class="stat-v" id="sProducts">0</div><div class="stat-l">Products</div></div>
      </div>
      <div class="adm-card"><h3>‚ö†Ô∏è Low Stock Alerts</h3><div id="lowStockDiv"><p style="font-size:0.82rem;color:var(--gray)">Loading...</p></div></div>
      <div class="adm-card"><h3>üïê Recent Orders</h3><div id="recentOrdersDiv"><p style="font-size:0.82rem;color:var(--gray)">Loading...</p></div></div>
    </div>

    <!-- ORDERS -->
    <div id="adm-orders" style="display:none">
      <input class="search-box" placeholder="üîç Search by name, product or order ID..." id="orderSearch" oninput="renderOrders()"/>
      <div class="filter-row">
        <div class="fpill active" onclick="setOrderFilter('all',this)">All</div>
        <div class="fpill" onclick="setOrderFilter('pending',this)">Pending</div>
        <div class="fpill" onclick="setOrderFilter('confirmed',this)">Confirmed</div>
        <div class="fpill" onclick="setOrderFilter('paid',this)">Paid</div>
        <div class="fpill" onclick="setOrderFilter('delivered',this)">Delivered</div>
      </div>
      <div id="ordersList"></div>
    </div>

    <!-- PRODUCTS -->
    <div id="adm-products" style="display:none">
      <button class="submit-btn" onclick="toggleAddProd()" style="margin-bottom:14px">+ Add New Product</button>
      <div id="addProdForm" style="display:none" class="adm-card">
        <h3>‚ûï New Product</h3>
        <div id="prodAlert"></div>
        <div class="fgroup"><label class="flabel">Product Name *</label><input class="finput" id="pName" placeholder="e.g. Floral Midi Dress"/></div>
        <div class="fgroup">
          <label class="flabel">Category</label>
          <select class="finput" id="pCat">
            <option>Dresses</option><option>Tops</option><option>Skirts</option>
            <option>Trousers</option><option>Suits</option><option>Accessories</option><option>Other</option>
          </select>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <div class="fgroup"><label class="flabel">Buying Price (TZS) *</label><input class="finput" id="pBuy" type="number" placeholder="0"/></div>
          <div class="fgroup"><label class="flabel">Selling Price (TZS) *</label><input class="finput" id="pSell" type="number" placeholder="0"/></div>
        </div>
        <div class="fgroup">
          <label class="flabel">Stock per Size</label>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">XS</div><input class="finput" id="sXS" type="number" value="0" style="padding:8px;text-align:center"/></div>
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">S</div><input class="finput" id="sS" type="number" value="0" style="padding:8px;text-align:center"/></div>
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">M</div><input class="finput" id="sM" type="number" value="0" style="padding:8px;text-align:center"/></div>
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">L</div><input class="finput" id="sL" type="number" value="0" style="padding:8px;text-align:center"/></div>
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">XL</div><input class="finput" id="sXL" type="number" value="0" style="padding:8px;text-align:center"/></div>
            <div><div style="font-size:0.7rem;color:var(--wine);font-weight:700;margin-bottom:4px">XXL</div><input class="finput" id="sXXL" type="number" value="0" style="padding:8px;text-align:center"/></div>
          </div>
        </div>
        <div class="fgroup">
          <label class="flabel">Product Photo (Optional)</label>
          <div class="upload-zone" onclick="document.getElementById('pImg').click()">
            <div style="font-size:2rem;margin-bottom:6px">üì∏</div>
            <div style="font-size:0.8rem;color:var(--gray)">Tap to upload product photo</div>
            <input type="file" id="pImg" accept="image/*" onchange="prevProdImg(event)" style="display:none"/>
            <img id="pImgPrev" style="display:none;width:100%;border-radius:10px;margin-top:10px;max-height:160px;object-fit:cover"/>
          </div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="submit-btn" onclick="saveProd()" style="flex:1">üíæ Save Product</button>
          <button class="btn-sm btn-outline" onclick="toggleAddProd()" style="padding:14px 16px;border-radius:14px">Cancel</button>
        </div>
      </div>
      <div id="productsList"></div>
    </div>

    <!-- ANALYTICS -->
    <div id="adm-analytics" style="display:none">
      <div class="adm-card">
        <h3>üìà Sales Chart (Last 7 Days)</h3>
        <div class="chart-wrap" id="salesChart"></div>
      </div>
      <div class="adm-card"><h3>üèÜ Best Selling Products</h3><div id="bestSellers"></div></div>
      <div class="adm-card"><h3>üí∞ Financial Summary</h3><div id="financialSummary"></div></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ORDER MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="overlay" id="orderModal">
  <div class="modal" style="position:relative">
    <div class="modal-handle"></div>
    <button class="close-x" onclick="closeModal()">‚úï</button>
    <div id="modalProductImg" style="width:100%;height:160px;border-radius:16px;overflow:hidden;margin-bottom:16px;background:linear-gradient(135deg,var(--rose-light),var(--border));display:flex;align-items:center;justify-content:center;font-size:4rem">üëó</div>
    <div class="modal-product-name" id="modalName">Product Name</div>
    <div class="modal-product-price" id="modalPriceTag">TZS 0</div>
    <div id="modalAlert"></div>

    <div class="fgroup">
      <label class="flabel">Select Size *</label>
      <div class="size-row" id="modalSizes"></div>
    </div>
    <div class="fgroup">
      <label class="flabel">Quantity</label>
      <div class="qty-row">
        <button class="qty-btn" onclick="chQty(-1)">‚àí</button>
        <div class="qty-num" id="qtyNum">1</div>
        <button class="qty-btn" onclick="chQty(1)">+</button>
      </div>
    </div>
    <div class="total-box">
      <div class="total-lbl">Total Amount</div>
      <div class="total-amt" id="modalTotal">TZS 0</div>
    </div>
    <div class="fgroup"><label class="flabel">Your Full Name *</label><input class="finput" id="cName" placeholder="e.g. Amina Hassan"/></div>
    <div class="fgroup"><label class="flabel">Phone Number *</label><input class="finput" id="cPhone" type="tel" placeholder="e.g. 0712 345 678"/></div>
    <div class="fgroup"><label class="flabel">Delivery Location *</label><input class="finput" id="cLocation" placeholder="e.g. Moshi Center, near Nakumatt"/></div>
    <div class="fgroup"><label class="flabel">Notes (Optional)</label><input class="finput" id="cNotes" placeholder="e.g. preferred color or special request"/></div>
    <button class="submit-btn" onclick="placeOrder()">üõç Place Order</button>
  </div>
</div>

<!-- SUCCESS -->
<div class="success-screen" id="successScreen">
  <div class="success-sparkle">üéâ</div>
  <h2>Order Placed!</h2>
  <p>Your order has been received!<br>Tap below to confirm via WhatsApp.</p>
  <div class="success-id" id="successId">Order #WIN000000</div>
  <a id="waConfirmBtn" href="#" target="_blank" class="wa-btn">
    <span style="font-size:1.4rem">üí¨</span> Confirm on WhatsApp
  </a>
  <button class="again-btn" onclick="resetSuccess()">üõç Continue Shopping</button>
</div>

<a class="wa-float" href="https://wa.me/255619066079" target="_blank">üí¨</a>

<script>
const BACKEND = 'https://winnestar-backend.onrender.com';
const IMGBB = '6d2dc476a33c1ba8a5e59521b4245400';

let adminToken = null;
let products = [];
let orders = [];
let selProduct = null;
let selSize = null;
let qty = 1;
let curCat = 'all';
let curOrderFilter = 'all';

// ‚îÄ‚îÄ HOURS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const HOURS = {
  0:{open:'10:00',close:'17:00'},
  1:{open:'08:00',close:'20:00'},
  2:{open:'08:00',close:'20:00'},
  3:{open:'08:00',close:'20:00'},
  4:{open:'08:00',close:'20:00'},
  5:{open:'08:00',close:'20:00'},
  6:{open:'08:00',close:'20:00'},
};
function fmtTime(t){const[h,m]=t.split(':').map(Number);const ap=h>=12?'PM':'AM';return`${h%12||12}:${m.toString().padStart(2,'0')} ${ap}`;}
function checkStatus(){
  const now=new Date(),d=now.getDay(),h=now.getHours()*60+now.getMinutes();
  const dh=HOURS[d],[oh,om]=dh.open.split(':').map(Number),[ch,cm]=dh.close.split(':').map(Number);
  const open=h>=oh*60+om&&h<ch*60+cm;
  const el=document.getElementById('navStatus');
  el.textContent=open?'‚óè Open':'‚óè Closed';
  el.className='status-pill '+(open?'status-open':'status-closed');
  document.getElementById('todayHours').textContent=`${fmtTime(dh.open)} ‚Äì ${fmtTime(dh.close)}`;
  // Highlight today row
  for(let i=0;i<=6;i++){const r=document.getElementById('row-'+i);if(r)r.className=i===d?'today-row':'';}
}

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showPage(p){
  document.querySelectorAll('.page').forEach(x=>x.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
  document.getElementById('page-'+p).classList.add('active');
  document.getElementById('tab-'+p).classList.add('active');
  if(p==='shop')loadProducts();
  if(p==='admin'&&adminToken)loadDash();
}

// ‚îÄ‚îÄ PRODUCTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadProducts(){
  try{
    const r=await fetch(`${BACKEND}/api/products`);
    const j=await r.json();
    if(j.success)products=j.data||[];
  }catch(e){}
  renderProducts();
}

function filterCat(cat,el){
  curCat=cat;
  document.querySelectorAll('.cat-pill').forEach(p=>p.classList.remove('active'));
  el.classList.add('active');
  renderProducts();
}

function renderProducts(){
  const grid=document.getElementById('productsGrid');
  let list=curCat==='all'?products:products.filter(p=>p.category===curCat);
  if(!list.length){
    grid.innerHTML=`<div style="grid-column:span 2;text-align:center;padding:50px 20px;color:var(--gray)"><div style="font-size:3rem;margin-bottom:10px">üëó</div><p>${products.length?'No products in this category':'No products yet ‚Äî check back soon!'}</p></div>`;
    return;
  }
  grid.innerHTML=list.map(p=>{
    const sizes=p.sizes||{};
    const allOut=Object.values(sizes).every(q=>q===0);
    const sHtml=Object.entries(sizes).filter(([,q])=>q>0).map(([s])=>`<span class="sz-dot">${s}</span>`).join('');
    const outHtml=Object.entries(sizes).filter(([,q])=>q===0).map(([s])=>`<span class="sz-dot out">${s}</span>`).join('');
    const imgEl=p.imageUrl?`<img class="pcard-img" src="${p.imageUrl}" alt="${p.name}" onerror="this.style.display='none'"/>`:`<div class="pcard-img-ph">üëó</div>`;
    return`<div class="pcard">
      <div class="pcard-img-wrap">${imgEl}<span class="pcard-badge">${p.category||'Fashion'}</span></div>
      <div class="pcard-body">
        <div class="pcard-cat">${p.category||'Fashion'}</div>
        <div class="pcard-name">${p.name}</div>
        <div class="pcard-price">TZS ${Number(p.sellingPrice).toLocaleString()}</div>
        <div class="pcard-sizes">${sHtml}${outHtml}</div>
        ${allOut?`<div class="pcard-btn out">Out of Stock</div>`:`<button class="pcard-btn" onclick="openModal('${p._id||p.id}')">üõç Order Now</button>`}
      </div>
    </div>`;
  }).join('');
}

// ‚îÄ‚îÄ ORDER MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openModal(id){
  selProduct=products.find(p=>(p._id||p.id)===id);
  if(!selProduct)return;
  selSize=null;qty=1;
  document.getElementById('qtyNum').textContent='1';
  document.getElementById('modalName').textContent=selProduct.name;
  document.getElementById('modalPriceTag').textContent='TZS '+Number(selProduct.sellingPrice).toLocaleString()+' per item';
  document.getElementById('modalAlert').innerHTML='';
  ['cName','cPhone','cLocation','cNotes'].forEach(i=>document.getElementById(i).value='');
  updateTotal();
  // Image
  const imgDiv=document.getElementById('modalProductImg');
  imgDiv.innerHTML=selProduct.imageUrl?`<img src="${selProduct.imageUrl}" style="width:100%;height:100%;object-fit:cover"/>`:
    `<div style="font-size:4rem">üëó</div>`;
  // Sizes
  const sizes=selProduct.sizes||{};
  document.getElementById('modalSizes').innerHTML=Object.entries(sizes).map(([s,q])=>
    `<button class="sz-btn${q===0?' out':''}" ${q===0?'disabled':''} onclick="pickSize('${s}',this)">${s}${q<=3&&q>0?` (${q}left)`:''}</button>`
  ).join('');
  document.getElementById('orderModal').classList.add('show');
}
function closeModal(){document.getElementById('orderModal').classList.remove('show');}
function pickSize(s,el){selSize=s;document.querySelectorAll('.sz-btn').forEach(b=>b.classList.remove('sel'));el.classList.add('sel');}
function chQty(d){qty=Math.max(1,qty+d);document.getElementById('qtyNum').textContent=qty;updateTotal();}
function updateTotal(){if(!selProduct)return;document.getElementById('modalTotal').textContent='TZS '+(selProduct.sellingPrice*qty).toLocaleString();}

async function placeOrder(){
  if(!selSize){document.getElementById('modalAlert').innerHTML='<div class="alert alert-err">Please select a size!</div>';return;}
  const name=document.getElementById('cName').value.trim();
  const phone=document.getElementById('cPhone').value.trim();
  const loc=document.getElementById('cLocation').value.trim();
  if(!name||!phone||!loc){document.getElementById('modalAlert').innerHTML='<div class="alert alert-err">Please fill in your name, phone and location!</div>';return;}
  const orderId='WIN'+Date.now().toString().slice(-6);
  const total=selProduct.sellingPrice*qty;
  const data={orderId,product:{id:selProduct._id||selProduct.id,name:selProduct.name,size:selSize,quantity:qty,price:selProduct.sellingPrice,total},customer:{name,phone,location:loc},notes:document.getElementById('cNotes').value.trim(),status:'pending'};
  try{await fetch(`${BACKEND}/api/orders`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});}catch(e){}
  closeModal();
  showSuccess(orderId,data);
}

function showSuccess(orderId,data){
  const{product:pr,customer:cu}=data;
  const msg=`üå∏ NEW ORDER ‚Äî Winnestar Moshi Fashion\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüëó Product: ${pr.name}\nüìè Size: ${pr.size}\nüî¢ Qty: ${pr.quantity}\nüí∞ Total: TZS ${pr.total.toLocaleString()}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüë§ Customer: ${cu.name}\nüì± Phone: ${cu.phone}\nüìç Location: ${cu.location}\nüÜî Order ID: ${orderId}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nPlease confirm this order. Thank you! üíú`;
  document.getElementById('successId').textContent='Order #'+orderId;
  const url=`https://wa.me/255619066079?text=${encodeURIComponent(msg)}`;
  const btn=document.getElementById('waConfirmBtn');
  btn.href=url;
  btn.onclick=e=>{e.preventDefault();window.open(url,'_blank');};
  document.getElementById('successScreen').classList.add('show');
}
function resetSuccess(){document.getElementById('successScreen').classList.remove('show');}

// ‚îÄ‚îÄ ADMIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function adminLogin(){
  const u=document.getElementById('adminUser').value.trim(),p=document.getElementById('adminPass').value;
  if(!u||!p){document.getElementById('loginAlert').innerHTML='<div class="alert alert-err">Please fill all fields!</div>';return;}
  try{
    const r=await fetch(`${BACKEND}/api/admin/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
    const j=await r.json();
    if(j.success||j.token){
      adminToken=j.token;
      document.getElementById('adminLogin').style.display='none';
      document.getElementById('adminDashboard').style.display='block';
      loadDash();
    }else{document.getElementById('loginAlert').innerHTML='<div class="alert alert-err">Invalid username or password!</div>';}
  }catch(e){document.getElementById('loginAlert').innerHTML='<div class="alert alert-err">Connection error. Please try again.</div>';}
}
function adminLogout(){
  adminToken=null;
  document.getElementById('adminLogin').style.display='block';
  document.getElementById('adminDashboard').style.display='none';
}
function admTab(t,el){
  document.querySelectorAll('.adm-tab').forEach(x=>x.classList.remove('active'));
  el.classList.add('active');
  ['overview','orders','products','analytics'].forEach(x=>{
    const d=document.getElementById('adm-'+x);
    if(d)d.style.display=x===t?'block':'none';
  });
  if(t==='orders')renderOrders();
  if(t==='products')renderProdsAdmin();
  if(t==='analytics')renderAnalytics();
}

async function loadDash(){
  try{
    const headers={'Authorization':'Bearer '+adminToken};
    const[or,pr]=await Promise.all([
      fetch(`${BACKEND}/api/orders`,{headers}),
      fetch(`${BACKEND}/api/products`,{headers})
    ]);
    const oj=await or.json(),pj=await pr.json();
    if(oj.success)orders=oj.data||[];
    if(pj.success)products=pj.data||[];
  }catch(e){}
  updateStats();renderLowStock();renderRecentOrders();
}

function fmtK(n){if(n>=1e6)return(n/1e6).toFixed(1)+'M';if(n>=1000)return(n/1000).toFixed(0)+'K';return String(n);}
function updateStats(){
  const del=orders.filter(o=>o.status==='delivered');
  const rev=del.reduce((s,o)=>s+(o.product?.total||0),0);
  const profit=del.reduce((s,o)=>{const p=products.find(x=>(x._id||x.id)===o.product?.id);return s+(p?(p.sellingPrice-p.buyingPrice)*(o.product?.quantity||1):0);},0);
  document.getElementById('sTotalOrders').textContent=orders.length;
  document.getElementById('sTotalSales').textContent=fmtK(rev);
  document.getElementById('sTotalProfit').textContent=fmtK(profit);
  document.getElementById('sProducts').textContent=products.length;
}

function renderLowStock(){
  const alerts=[];
  products.forEach(p=>Object.entries(p.sizes||{}).forEach(([s,q])=>{if(q>0&&q<=3)alerts.push({name:p.name,size:s,qty:q});}));
  const el=document.getElementById('lowStockDiv');
  el.innerHTML=alerts.length?alerts.map(a=>`<div class="low-alert">‚ö†Ô∏è <strong>${a.name}</strong> ‚Äî Size ${a.size}: Only <strong>${a.qty}</strong> remaining!</div>`).join(''):'<p style="font-size:0.82rem;color:var(--gray)">‚úÖ All stock levels are healthy</p>';
}

function renderRecentOrders(){
  const recent=[...orders].sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)).slice(0,3);
  document.getElementById('recentOrdersDiv').innerHTML=recent.length?recent.map(o=>orderCardHtml(o)).join(''):'<p style="font-size:0.82rem;color:var(--gray)">No orders yet</p>';
}

function orderCardHtml(o){
  const bc={pending:'b-pending',confirmed:'b-confirmed',paid:'b-paid',delivered:'b-delivered'}[o.status]||'b-pending';
  const date=o.createdAt?new Date(o.createdAt).toLocaleDateString('en-GB'):'Today';
  return`<div class="order-card">
    <div class="order-top">
      <span class="order-num">#${o.orderId||o._id?.slice(-6)}</span>
      <span class="badge ${bc}">${o.status||'pending'}</span>
    </div>
    <div class="order-info"><strong>${o.product?.name||'Product'}</strong> ‚Äî Size ${o.product?.size||'-'} √ó ${o.product?.quantity||1}</div>
    <div class="order-info">üë§ ${o.customer?.name||'-'} &nbsp;üì± ${o.customer?.phone||'-'}</div>
    <div class="order-info">üìç ${o.customer?.location||'-'}</div>
    <div class="order-info">üí∞ TZS ${(o.product?.total||0).toLocaleString()} &nbsp;üìÖ ${date}</div>
    <select class="status-sel" onchange="updateStatus('${o._id||o.orderId}',this.value)">
      <option value="pending" ${o.status==='pending'?'selected':''}>‚è≥ Pending</option>
      <option value="confirmed" ${o.status==='confirmed'?'selected':''}>‚úÖ Confirmed</option>
      <option value="paid" ${o.status==='paid'?'selected':''}>üí∞ Paid</option>
      <option value="delivered" ${o.status==='delivered'?'selected':''}>üöö Delivered</option>
    </select>
  </div>`;
}

function renderOrders(){
  const q=(document.getElementById('orderSearch')?.value||'').toLowerCase();
  let list=orders.filter(o=>
    (o.orderId||'').toLowerCase().includes(q)||
    (o.customer?.name||'').toLowerCase().includes(q)||
    (o.product?.name||'').toLowerCase().includes(q)
  );
  if(curOrderFilter!=='all')list=list.filter(o=>o.status===curOrderFilter);
  list.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));
  const el=document.getElementById('ordersList');
  el.innerHTML=list.length?list.map(o=>orderCardHtml(o)).join(''):'<p style="font-size:0.82rem;color:var(--gray);text-align:center;padding:24px">No orders found</p>';
}
function setOrderFilter(f,el){curOrderFilter=f;document.querySelectorAll('#adm-orders .fpill').forEach(p=>p.classList.remove('active'));el.classList.add('active');renderOrders();}
async function updateStatus(id,status){
  try{await fetch(`${BACKEND}/api/orders/${id}/status`,{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':'Bearer '+adminToken},body:JSON.stringify({status})});}catch(e){}
  const o=orders.find(x=>(x._id||x.orderId)===id);if(o)o.status=status;updateStats();
}

// Products admin
function renderProdsAdmin(){
  const el=document.getElementById('productsList');
  el.innerHTML=products.length?products.map(p=>{
    const sizes=p.sizes||{};
    const chips=Object.entries(sizes).map(([s,q])=>`<span class="chip ${q===0?'c-out':q<=3?'c-low':'c-ok'}">${s}:${q}</span>`).join('');
    const img=p.imageUrl?`<img src="${p.imageUrl}" style="width:58px;height:58px;border-radius:10px;object-fit:cover"/>`:`<div class="prod-thumb">üëó</div>`;
    const profit=p.sellingPrice-p.buyingPrice;
    return`<div class="prod-row">${img}<div class="prod-info"><div class="prod-name">${p.name} <span style="font-size:0.68rem;color:var(--gray)">(${p.category})</span></div><div class="prod-price-line">Buy TZS ${Number(p.buyingPrice).toLocaleString()} ¬∑ Sell TZS ${Number(p.sellingPrice).toLocaleString()} ¬∑ Profit TZS ${profit.toLocaleString()}</div><div class="stock-chips">${chips}</div></div><button class="btn-sm btn-red" onclick="deleteProd('${p._id||p.id}')">üóë</button></div>`;
  }).join(''):'<p style="font-size:0.82rem;color:var(--gray);text-align:center;padding:24px">No products yet. Add your first product!</p>';
}

let showProd=false;
function toggleAddProd(){showProd=!showProd;document.getElementById('addProdForm').style.display=showProd?'block':'none';}
function prevProdImg(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{const img=document.getElementById('pImgPrev');img.src=ev.target.result;img.style.display='block';};r.readAsDataURL(f);}
async function uploadImgBB(b64){try{const fd=new FormData();fd.append('image',b64);fd.append('key',IMGBB);const r=await fetch('https://api.imgbb.com/1/upload',{method:'POST',body:fd});const j=await r.json();return j.success?j.data.url:null;}catch(e){return null;}}

async function saveProd(){
  const name=document.getElementById('pName').value.trim();
  const buy=Number(document.getElementById('pBuy').value);
  const sell=Number(document.getElementById('pSell').value);
  const cat=document.getElementById('pCat').value;
  if(!name||!buy||!sell){document.getElementById('prodAlert').innerHTML='<div class="alert alert-err">Please fill name, buying price and selling price!</div>';return;}
  const sizes={XS:+document.getElementById('sXS').value,S:+document.getElementById('sS').value,M:+document.getElementById('sM').value,L:+document.getElementById('sL').value,XL:+document.getElementById('sXL').value,XXL:+document.getElementById('sXXL').value};
  let imageUrl=null;
  const file=document.getElementById('pImg').files[0];
  if(file){const b64=await new Promise(r=>{const rd=new FileReader();rd.onload=e=>r(e.target.result.split(',')[1]);rd.readAsDataURL(file);});imageUrl=await uploadImgBB(b64);}
  try{
    const r=await fetch(`${BACKEND}/api/products`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+adminToken},body:JSON.stringify({name,category:cat,buyingPrice:buy,sellingPrice:sell,sizes,imageUrl})});
    const j=await r.json();
    if(j.success||j._id){
      products.push(j.data||j);
      toggleAddProd();renderProdsAdmin();updateStats();
      document.getElementById('prodAlert').innerHTML='';
      ['pName','pBuy','pSell'].forEach(id=>document.getElementById(id).value='');
      ['sXS','sS','sM','sL','sXL','sXXL'].forEach(id=>document.getElementById(id).value=0);
      document.getElementById('pImgPrev').style.display='none';
    }
  }catch(e){document.getElementById('prodAlert').innerHTML='<div class="alert alert-err">Error saving. Try again.</div>';}
}

async function deleteProd(id){
  if(!confirm('Delete this product?'))return;
  try{await fetch(`${BACKEND}/api/products/${id}`,{method:'DELETE',headers:{'Authorization':'Bearer '+adminToken}});}catch(e){}
  products=products.filter(p=>(p._id||p.id)!==id);renderProdsAdmin();updateStats();
}

// Analytics
function renderAnalytics(){
  const days=[];
  for(let i=6;i>=0;i--){
    const d=new Date();d.setDate(d.getDate()-i);
    const ds=d.toDateString();
    const dayOrd=orders.filter(o=>o.status==='delivered'&&new Date(o.createdAt).toDateString()===ds);
    days.push({lbl:['Su','Mo','Tu','We','Th','Fr','Sa'][d.getDay()],val:dayOrd.reduce((s,o)=>s+(o.product?.total||0),0)});
  }
  const max=Math.max(...days.map(d=>d.val),1);
  document.getElementById('salesChart').innerHTML=days.map(d=>`<div class="bar-col"><div class="bar-v">${d.val>0?fmtK(d.val):''}</div><div class="bar-fill" style="height:${Math.max(4,(d.val/max)*145)}px"></div><div class="bar-lbl">${d.lbl}</div></div>`).join('');

  // Best sellers
  const ps={};
  orders.filter(o=>o.status==='delivered').forEach(o=>{const k=o.product?.name||'?';ps[k]=(ps[k]||0)+(o.product?.quantity||1);});
  const sorted=Object.entries(ps).sort((a,b)=>b[1]-a[1]).slice(0,5);
  document.getElementById('bestSellers').innerHTML=sorted.length?sorted.map(([n,q],i)=>`<div class="best-row"><span>${['ü•á','ü•à','ü•â','4Ô∏è‚É£','5Ô∏è‚É£'][i]} ${n}</span><span style="font-weight:700;color:var(--wine)">${q} sold</span></div>`).join(''):'<p style="font-size:0.82rem;color:var(--gray)">No delivered orders yet</p>';

  // Financial
  const del=orders.filter(o=>o.status==='delivered');
  const rev=del.reduce((s,o)=>s+(o.product?.total||0),0);
  const cost=del.reduce((s,o)=>{const p=products.find(x=>(x._id||x.id)===o.product?.id);return s+(p?p.buyingPrice*(o.product?.quantity||1):0);},0);
  const profit=rev-cost;
  document.getElementById('financialSummary').innerHTML=`
    <div class="profit-row"><span>Total Revenue</span><span style="font-weight:700;color:var(--wine)">TZS ${rev.toLocaleString()}</span></div>
    <div class="profit-row"><span>Total Cost</span><span style="font-weight:700;color:#EF4444">TZS ${cost.toLocaleString()}</span></div>
    <div class="profit-row"><span>Net Profit</span><span style="font-weight:700;color:#16A34A">TZS ${profit.toLocaleString()}</span></div>
    <div class="profit-row"><span>Profit Margin</span><span style="font-weight:700;color:var(--gold)">${rev>0?((profit/rev)*100).toFixed(1):0}%</span></div>
    <div class="profit-row"><span>Total Orders Delivered</span><span style="font-weight:700;color:var(--dark)">${del.length}</span></div>`;
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
checkStatus();
setInterval(checkStatus,60000);
fetch(`${BACKEND}/api/health`).catch(()=>{});
</script>
</body>
</html>
